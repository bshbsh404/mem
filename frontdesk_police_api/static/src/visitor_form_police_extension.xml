<?xml version="1.0" encoding="UTF-8"?>

<templates xml:space="preserve">
    <!-- ÿßŸÖÿ™ÿØÿßÿØ ŸÑŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿ≤ÿßÿ¶ÿ± ŸÑÿ•ÿ∂ÿßŸÅÿ© ŸÜŸàÿπ "ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ¥ÿ±ÿ∑ÿ©" -->
    <t t-name="frontdesk.VisitorForm" t-inherit="frontdesk.VisitorForm" t-inherit-mode="extension">
        
        <!-- ÿ•ÿ∂ÿßŸÅÿ© ŸÜŸàÿπ ÿ≤ÿßÿ¶ÿ± ÿ¨ÿØŸäÿØ -->
        <xpath expr="//div[@class='form-check' and .//input[@value='employee']]" position="after">
            <div class="form-check">
                <label class="form-check-label" for="visitorTypePolice">Police Database Lookup</label>
                <input type="radio" id="visitorTypePolice" name="visitorType" value="police_id" 
                       class="form-check-input" t-on-change="_onVisitorTypeChange" 
                       t-att-checked="state.visitorType === 'police_id'"/>
            </div>
        </xpath>

        <!-- ÿ•ÿ∂ÿßŸÅÿ© ŸÇÿ≥ŸÖ ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ¥ÿ±ÿ∑ÿ© -->
        <xpath expr="//div[contains(@class, 'mt-3') and .//input[@id='visitor_id']]" position="after">
            <div t-if="state.visitorType === 'police_id'" class="mt-3 col-12">
                <div class="row">
                    <div class="col-6">
                        <label for="police_civil_id" class="form-label">
                            Civil ID for ROP Lookup 
                            <span class="small text-danger">*</span>
                        </label>
                        <input type="text" 
                               minlength="8" 
                               maxlength="12" 
                               pattern="[0-9]{8,12}" 
                               autocomplete="off" 
                               class="form-control" 
                               t-att-class="props.theme === 'light' ? '' : 'bg-700 border-0 text-white'" 
                               id="police_civil_id" 
                               t-ref="inputVisitorID" 
                               placeholder="Enter Civil ID (8-12 digits)" 
                               required="required"/>
                    </div>
                    <div class="col-4">
                        <label for="card_expiry_date" class="form-label">
                            Card Expiry Date
                            <span class="small text-danger">*</span>
                        </label>
                        <input type="date" 
                               autocomplete="off" 
                               class="form-control" 
                               t-att-class="props.theme === 'light' ? '' : 'bg-700 border-0 text-white'" 
                               id="card_expiry_date" 
                               t-ref="inputCardExpiry" 
                               required="required"/>
                    </div>
                    <div class="col-2 d-flex align-items-end">
                        <button type="button" 
                                class="btn btn-primary w-100" 
                                t-on-click="_onPoliceIdLookup"
                                t-att-disabled="state.isPoliceApiLoading">
                            <span t-if="!state.isPoliceApiLoading">üîç Lookup</span>
                            <span t-if="state.isPoliceApiLoading">
                                <i class="fa fa-spinner fa-spin"></i> Searching...
                            </span>
                        </button>
                    </div>
                </div>
                
                <!-- ÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿÆÿ∑ÿ£ ÿ£Ÿà ÿßŸÑŸÜÿ¨ÿßÿ≠ -->
                <div t-if="state.policeApiError" class="alert alert-danger mt-2">
                    <i class="fa fa-exclamation-triangle"></i>
                    <span t-esc="state.policeApiError"/>
                </div>
                
                <!-- ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ -->
                <div t-if="state.isPoliceApiLoading" class="text-center mt-2">
                    <div class="spinner-border text-primary" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <p class="mt-2 text-muted">Searching police database...</p>
                </div>
            </div>
        </xpath>

        <!-- ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿßÿπÿØÿ© ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ -->
        <xpath expr="//div[contains(@class, 'mt-3') and .//label[contains(text(), 'Identification Type')]]" position="before">
            <div t-if="state.visitorType === 'police_id'" class="alert alert-info mt-3">
                <i class="fa fa-info-circle"></i>
                <strong>Police Database Lookup:</strong> 
                Enter the visitor's Civil ID and click "Lookup" to automatically fill their information from the police database.
            </div>
        </xpath>

    </t>
</templates>